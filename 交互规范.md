# 交互规范

> 有疑问和设计师提前确认做好同步，确定好后必须精准还原

### 表单

1. 普通组件
   - 非空校验：必填项空输入时保存和提交失败，对应的输入框标红提示。
   - 合法性校验：比如手机号，只允许输入数字和+号，价格只允许输入数字和小数点，库存只允许输入无符号整数，邮箱地址必须是 xx@xx 格式。
   - 敏感词校验：涉及黄赌毒和政治敏感词，提交失败，展示错误提示。
   - 长度限制：前端必须对输入长度限制，且长度限制必须小于后端数据库的长度限制，用户输入超过限制时有提示；有最短输入限制要求的，同样也要做相应处理。
   - 校验时机：在刚进入 Form 表单时，不进行错误提示，只有当用户有操作输入之后才会对输入进行校验。
   - 样式合理：输入框的宽高设置合理，尽量保证大部分情况下输入内容都能看到；多行输入框，需要确认是否可以滚动；多个输入框，注意水平对齐和垂直对齐。
2. 集合组件：如果多个组件共享同一个表单校验时机，共享同一条报错内容，我们把他们的集合叫做集合组件，如下图所示。集合组件大量存在于前端的业务代码之中，由各个业务部门开发管理。目前，目前集合组件的表单校验时机，还有报错标红范围没有规范，我们希望可以收敛到一个统一的标准，从而可以极大地提升用户的体验。
   - 谁报错谁标红：集合组件由多个组件所组成，如果子组件 A 合法而子组件 B 非法，那么只给非法的子组件 B 标红，合法的子组件 A 不标红。
   - 组件校验时机：1. 表单提交的时候，一定做校验。2. 子组件首次输入之前不做校验；首次输入之后，当集合组件整体失去焦点的时候，开始校验。3. 子组件输入的时候，除了情况 2，一定做校验。
3. 字符编码，对于中英文和特殊字符等都可输入的场景，需要中文、英文、特殊符号等都能正常展示。
4. xss 安全校验，针对允许中英文和特殊字符的输入场景，需要做好转义处理，保证无 xss 漏洞。

> ![img](imgs\集合组件)
>
> 集合组件

### 列表

1. 空列表：展示默认文案或图片，提示用户无相关数据；
2. 单页列表：无需页码列表，页码不可切换上/下一页。
3. 多页列表：页码可切回上/下一页，页码较多时应设计可以切换到第一页/最后一页。
4. 对齐，同列或者同行的个别元素内容较长出现换行时，需保持行对齐和列对齐，视觉上无跳跃性。

### 按钮和超链接

1. 商家端的可点击的元素，例如 a/button 等，鼠标指针需要注意样式的处理，如 cursor: pointer。
2. 商家端的超链接元素，我们统一使用 a 标签，获得继承下来的颜色值(#38f)。
3. 提交按钮，需要做拦截避免重复提交到后端；提交时，按钮改为 loading 状态，不可重复点击。
4. 选中态，对于提交和保存这类按钮，点击时样式发生变化，变为选中态。
5. 热区合理，按钮所在的任意区域，都可响应用户的点击操作；热区不能过小（热区最小 44px\*44px），过小则不容易点中。

> ![img](imgs\点击热点)

### 图片缩略图

1. 在列表中使用图片时，通常不需要展示大图，此时需要使用 fullfillImage 组件对图片进行处理，转为小图模式。图片在任何时候，都不要拉伸显示。
2. 商家端和手机端，如果图片宽高比与设计稿不一致，背景用模糊衬底填充

> ![img](imgs\模糊)
>
> 手机端填充模糊背景

### 价格计算

1. 为避免出现 19.9 \* 100 问题，价格相关的加减乘除请使用 zanutils money 里面提供的加减乘除方法。

### Loading

1. 避免不必要的 loading 或者 loading 缺失。
2. 通常页面只需要一个 loading，避免出现一次请求多次 loading。
3. 瀑布流加载，避免遮屏 loading，应该使用瀑布流最下方的 loading。

### 滑动

1. banner 左右滑动的场景，需要注意是否跟 ios 右滑退出页面冲突。
2. 手机端页面列表上下滑动，列表比较长，比如超过 5 屏，需要增加分页逻辑；滑动加载下一页时需要 loading 动画提示，拉到最后一条需要提示已加载全部。
3. 列表中图片需设置默认占位图，避免图片加载慢时页面视觉上出现跳动。

> ![img](imgs\提示全部加载)
>
> ![img](imgs\占位图)
>
> 设置默认占位图

### 体验一致性

1. 主题颜色跟肤，比如设置店铺主题色为粉色系，商品详情页对应的按钮的颜色、营销活动的颜色页应该是粉色。
2. 手机端页面，屏幕宽度较窄，文本类需要考虑超长截断、多行对齐，不破坏原本设计的页面结构。
3. ui 一致性，比如同个 app，不同页面商品图使用的占位图建议是同一张图切出来的不同规格的图片，用到的保存成功、失败这类弹框提示是同样的 ui 风格，用到的 loading 小圆圈建议是同一个 icon，使用的字体一致。
4. 交互一致性，类似的交互场景，交互习惯需保持一致，比如同个 app，二次确认框，除非特殊要求，否则取消和确定的左右位置应该保持一致。

### 容错处理

1. 请求后端接口，需要设置请求超时时间（非上传请求建议最多不超过 5s），超时后提示请求超时。
2. 图片拉取失败展示默认占位图。
3. 提交失败时展示错误提示。
4. 表单等内容提交时，如遇失败，不做页面跳转，保留用户输入内容，可在当前页面点击按钮再次重试提交。
5. 页面拉取内容失败时（比如手机打开页面 404），可通过返回、关闭退出页面，或者切换 tab 回到其他页面。
6. 手机端涉及音视频，需要考虑播放过程中电话、闹铃、前后台切换、锁屏等事件和静音开关设置。
7. 手机端需要考虑多次切换横竖屏后，页面是否正常展示。
8. B 端活动页面活动失效情况 活动失效后，只能查看，不要保留任何保存或者编辑行为，否则会在体验上给用户误导
9. B 端所有独立页面，需要考虑页面右侧的 help 区域，引入 pageHelp 组件
10. 数据脱敏规则(后端做，我们不做)

附表

1. 更多输入框规范，参考设计师整理的[输入框规范]
2. 更多文案规范，参考设计整理的[文案规范]，我们还有个 eslint 的插件来检查代码里有没有这些不规范的词，建议设置成 warning。
